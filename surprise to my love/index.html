<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8" />
    <title>给子琦的浪漫惊喜</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            background-color: #fff0f5;
            font-family: 'KaiTi', cursive;
            height: 100%;
            overflow: hidden;
        }

        #cover {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffd6e8, #fff0f5);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 10;
            animation: fadeIn 1s;
        }

        #cover h1 {
            font-size: 26px;
            text-align: center;
            margin: 20px;
            color: #d63384;
            padding: 0 20px;
        }

        #cover button {
            padding: 10px 20px;
            font-size: 18px;
            background-color: #ff69b4;
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        #main-content {
            display: none;
        }

        .heart {
            width: 100px;
            height: 90px;
            background-color: red;
            position: relative;
            margin: 40px auto;
            transform: rotate(-45deg);
            animation: heartbeat 1s infinite;
        }

        .heart::before,
        .heart::after {
            content: "";
            width: 100px;
            height: 90px;
            background-color: red;
            border-radius: 50%;
            position: absolute;
        }

        .heart::before {
            top: -50px;
            left: 0;
        }

        .heart::after {
            left: 50px;
            top: 0;
        }

        @keyframes heartbeat {

            0%,
            100% {
                transform: scale(1) rotate(-45deg);
            }

            50% {
                transform: scale(1.2) rotate(-45deg);
            }
        }

        .type-text {
            font-size: 18px;
            text-align: center;
            max-width: 90vw;
            margin: 30px auto;
            line-height: 1.8;
            word-break: break-word;
            padding: 0 10px;
        }
    </style>
</head>

<body>
    <!-- 📘 封面书页 -->
    <div id="cover">
        <h1>《如何让姜子琦对我重新感兴趣》</h1>
        <button onclick="openBook()">点击此处敲打隋沛雨</button>
    </div>

    <!-- 🎬 主内容 -->
    <div id="main-content">
        <div class="heart"></div>

        <!-- 背景音乐，循环播放 -->
        <audio id="bgm" preload="auto" loop>
            <source src="iloveyou.mp3" type="audio/mpeg" />
        </audio>

        <!-- 你的录音，播放一次 -->
        <audio id="voice" preload="auto">
            <source src="your-voice.mp3" type="audio/mpeg" />
        </audio>

        <div id="typewriter" class="type-text"></div>
    </div>

    <script>
        const text = `子琦，谢谢你在我最不完美的时候依然选择我、相信我、包容我。你的温柔与坚定，是我此生最珍贵的幸运。我愿用尽余生的温柔，回应你每一次回头的目光。此心已定，与你走进婚姻的殿堂，不是冲动，而是深思熟虑后的笃定。我爱你，至深、至久、至唯一。`;
        let i = 0;
        const speed = 200;

        function typeWriter() {
            if (i < text.length) {
                document.getElementById("typewriter").innerHTML += text.charAt(i);
                i++;
                setTimeout(typeWriter, speed);
            }
        }

        function openBook() {
            document.getElementById("cover").style.display = "none";
            document.getElementById("main-content").style.display = "block";

            const voice = document.getElementById("voice");
            const bgm = document.getElementById("bgm");

            // 播放录音，开始打字
            voice.play().then(() => {
                typeWriter();
            }).catch(() => {
                // 若自动播放失败，先启动打字，显示播放按钮
                typeWriter();
                showPlayButton();
            });

            // 录音结束后播放背景音乐
            voice.onended = () => {
                bgm.play().catch(() => {
                    showPlayButton();
                });
            };

            // 自动播放按钮（播放背景音乐和录音）
            function showPlayButton() {
                const btn = document.createElement("button");
                btn.textContent = "点击播放录音和音乐";
                btn.style = `
                    position: fixed;
                    top: 20px;
                    left: 20px;
                    z-index: 999;
                    padding: 10px 20px;
                    font-size: 16px;
                    background-color: pink;
                    border: none;
                    border-radius: 8px;
                    cursor: pointer;
                `;
                btn.onclick = function () {
                    voice.play();
                    bgm.play();
                    btn.remove();
                };
                document.body.appendChild(btn);
            }
        }
    </script>
</body>

</html>